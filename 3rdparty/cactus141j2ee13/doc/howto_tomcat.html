<HTML><HEAD><TITLE>Tomcat Quickstart</TITLE></HEAD><BODY alink="#023264" bgcolor="#ffffff" leftmargin="4" link="#525D76" marginheight="4" marginwidth="4" text="#000000" topmargin="4" vlink="#023264"><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD align="left" valign="top"><A href="http://jakarta.apache.org/index.html"><IMG border="0" hspace="0" src="./images/jakarta-logo.gif" vspace="0"></A></TD><TD align="left" bgcolor="#ffffff" valign="middle" width="100%"><IMG align="right" alt="Tomcat Quickstart" border="0" hspace="0" src=".//images/logocactus.gif" vspace="0"></TD></TR><TR><TD colspan="2" height="2" width="100%"><HR noshade="" size="1"></TD></TR></TABLE><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD valign="top" width="1%"></TD><TD nowrap="1" valign="top" width="14%"><FONT size="-2">
              Last update : August 31 2002</FONT><BR><FONT size="-2">
              Doc for : v1.4.1</FONT><BR><FONT face="arial,helvetica,sanserif">

  <BR><FONT color="#000000" size="+1">About</FONT><BR><FONT size="-1">
    <LI><A href="./index.html"><FONT size="-1">What is Cactus ?</FONT></A></LI>
    <LI><A href="./news.html"><FONT size="-1">News</FONT></A></LI>
    <LI><A href="./changes.html"><FONT size="-1">Changes</FONT></A></LI>
    <LI><A href="./features.html"><FONT size="-1">Features/Status</FONT></A></LI>
    <LI><A href="./goals.html"><FONT size="-1">Goals</FONT></A></LI>
    <LI><A href="./todo.html"><FONT size="-1">Roadmap/Todo</FONT></A></LI>
    <LI><A href="./contributors.html"><FONT size="-1">Contributors</FONT></A></LI>
    <LI><A href="./contributing.html"><FONT size="-1">Contributing</FONT></A></LI>
    <LI><A href="./users.html"><FONT size="-1">Cactus Users</FONT></A></LI>
    <LI><A href="./testedon.html"><FONT size="-1">Tested on ...</FONT></A></LI>
    <LI><A href="./license.html"><FONT size="-1">License</FONT></A></LI>
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Downloads</FONT><BR><FONT size="-1">
    <LI><A href="./downloads.html"><FONT size="-1">Downloads</FONT></A></LI>
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Documentation</FONT><BR><FONT size="-1">
    <LI><A href="./how_it_works.html"><FONT size="-1">How it works ?</FONT></A></LI>
    
    <LI><A href="./getting_started.html"><FONT size="-1">Getting Started</FONT></A></LI>
    <LI><A href="./mockobjects.html"><FONT size="-1">Mock vs Container</FONT></A></LI>
    <LI><A href="./javadoc.html"><FONT size="-1">Javadocs</FONT></A></LI>
    
    
    <LI><A href="./faq.html"><FONT size="-1">FAQ</FONT></A></LI>
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Howto Guides</FONT><BR><FONT size="-1">
    <LI><A href="./howto_classpath.html"><FONT size="-1">Classpath Howto</FONT></A></LI>
    <LI><A href="./howto_config.html"><FONT size="-1">Config Howto</FONT></A></LI>
    <LI><A href="./howto_migration.html"><FONT size="-1">Migration Howto</FONT></A></LI>

    
    <LI><A href="./howto_testcase.html"><FONT size="-1">TestCase Howto</FONT></A></LI>
    
    
    

    <LI><A href="./howto_jsp.html"><FONT size="-1">Jsp Howto</FONT></A></LI>
    <LI><A href="./howto_runner.html"><FONT size="-1">Runner Howto</FONT></A></LI>
    <LI><A href="./howto_security.html"><FONT size="-1">Security Howto</FONT></A></LI>

    
    <LI><A href="./howto_ant.html"><FONT size="-1">Ant Howto</FONT></A></LI>
    
    
    

    <LI><A href="./howto_httpunit.html"><FONT size="-1">HttpUnit Howto</FONT></A></LI>
    <LI><A href="./howto_sample.html"><FONT size="-1">Sample Howto</FONT></A></LI>

    
    <LI><A href="./howto_ejb.html"><FONT size="-1">EJB Howto</FONT></A></LI>
    

    
    <LI><A href="./howto_ide.html"><FONT size="-1">IDE Howto</FONT></A></LI>
    
    
    
    

    <LI><A href="./howto_tomcat.html"><FONT size="-1">Tomcat Howto</FONT></A></LI>

    <LI><A href="./howto_junitee.html"><FONT size="-1">JUnitEE Howto</FONT></A></LI>
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Support</FONT><BR><FONT size="-1">
    <LI><FONT size="-1"><A href="http://jakarta.apache.org/site/bugs.html" target="">Bug database</A></FONT></LI>
    <LI><A href="./mailinglist.html"><FONT size="-1">Mailing list</FONT></A></LI>
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Misc.</FONT><BR><FONT size="-1">
    <LI><A href="./cactusname.html"><FONT size="-1">Why the name ?</FONT></A></LI>
    <LI><A href="./logos.html"><FONT size="-1">Logo Challenge</FONT></A></LI>
    <LI><A href="./resources.html"><FONT size="-1">Resources</FONT></A></LI>
    <LI><A href="./coverage.html"><FONT size="-1">Test Coverage</FONT></A></LI>
    
    
    
    <LI><FONT size="-1"><A href="http://jakarta.apache.org/cactus/stats/index.html" target="">Stats</A></FONT></LI>
    
  </FONT><BR>

  <BR><FONT color="#000000" size="+1">Developers</FONT><BR><FONT size="-1">
    <LI><FONT size="-1"><A href="http://jakarta.apache.org/site/cvsindex.html" target="">CVS</A></FONT></LI>
    <LI><A href="./coding_conventions.html"><FONT size="-1">Coding Conventions</FONT></A></LI>
    <LI><A href="./build_result.html"><FONT size="-1">Build results</FONT></A></LI>
    <LI><A href="./release_checklist.html"><FONT size="-1">Release Checklist</FONT></A></LI>
  </FONT><BR>

</FONT></TD><TD align="left" valign="top" width="*"><TABLE border="0" cellpadding="3" cellspacing="0"><TR><TD><BR>
  

  

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Tomcat Quickstart forewords</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>

      <P><TABLE border="0" cellpadding="0" cellspacing="3" width="100%"><TR><TD valign="top" width="28"><IMG alt="Note" border="0" height="29" hspace="0" src="images/note.gif" vspace="0" width="28"></TD><TD valign="top"><FONT color="#000000" face="arial,helvetica,sanserif" size="-1"><I>
        This tutorial applies to Cactus 1.4 or greater and Tomcat 4.0 or
        greater.
      </I></FONT></TD></TR></TABLE></P>

      <P align="justify">
        This document is a step by step tutorial that explains how to set up
        Cactus and run Cactus tests in Tomcat in less than 10 minutes !
        (discounting download time of course :-)).
      </P>
      <P align="justify">
        There are 2 ways of packaging Cactus so that you can execute Cactus
        tests on your application :
      </P>
      <BLOCKQUOTE><UL>
        <LI>
          By putting all Cactus jars in your <CODE><FONT face="courier, monospaced">WEB-INF/lib</FONT></CODE> directory,
          as described in the <A href="howto_classpath.html">Classpath
          Tutorial</A>,
        </LI>
        <LI>
          By putting the Cactus jars in your container classpath so that Cactus
          will load them using the container Context class loader. This
          tutorial will describe this strategy as it is the less intrusive one
          and provides reuse of Cactus jars across several webapps.
        </LI>
      </UL></BLOCKQUOTE>
      <P align="justify">
        In addition to this, there are several ways to trigger the execution of
        the Cactus tests (see the <A href="howto_runner.html">TestRunner
        Howto</A> tutorial). We will describe the easiest one to set up in
        this tutorial, which is by using a browser.
      </P>
      <P><TABLE border="0" cellpadding="0" cellspacing="3" width="100%"><TR><TD valign="top" width="28"><IMG alt="Note" border="0" height="29" hspace="0" src="images/note.gif" vspace="0" width="28"></TD><TD valign="top"><FONT color="#000000" face="arial,helvetica,sanserif" size="-1"><I>
        Step 1 to step 3 are a one time install steps that you need to perform
        only once to be able to run Cactus tests within Tomcat.
      </I></FONT></TD></TR></TABLE></P>

    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 1 : Install Tomcat</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>
      <P align="justify">
        Download <A href="http://jakarta.apache.org/builds/jakarta-tomcat-4.0/release/">Tomcat</A>
        4.0 or greater and unzip it in any directory. Let's call this directory
        <CODE><FONT face="courier, monospaced">[tomcat root]</FONT></CODE>.
      </P>
    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 2 : Copy the Cactus jars</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>
      <P align="justify">
        Download the Cactus jars from the <A href="downloads.html">Cactus
        download page</A>. They are located in the <CODE><FONT face="courier, monospaced">lib/</FONT></CODE>
        directory in the zip.
      </P>
      <P align="justify">
        Copy the following jars to <CODE><FONT face="courier, monospaced">[tomcat root]/common/lib</FONT></CODE> :
      </P>
      <BLOCKQUOTE><UL>
        <LI>
          <CODE><FONT face="courier, monospaced">cactus.jar</FONT></CODE>
        </LI>
        <LI>
          <CODE><FONT face="courier, monospaced">commons-httpclient.jar</FONT></CODE>
        </LI>
        <LI>
          <CODE><FONT face="courier, monospaced">commons-logging.jar</FONT></CODE>
        </LI>
        <LI>
          <CODE><FONT face="courier, monospaced">junit.jar</FONT></CODE>
        </LI>
        <LI>
          <CODE><FONT face="courier, monospaced">aspectjrt.jar</FONT></CODE>
        </LI>
      </UL></BLOCKQUOTE>
      <P><TABLE border="0" cellpadding="0" cellspacing="3" width="100%"><TR><TD valign="top" width="28"><IMG alt="Note" border="0" height="29" hspace="0" src="images/note.gif" vspace="0" width="28"></TD><TD valign="top"><FONT color="#000000" face="arial,helvetica,sanserif" size="-1"><I>
        This is the minium set of jars needed. If later on you wish to use the
        Cactus <A href="howto_httpunit.html">HttpUnit integration</A>
        you'll also need to copy <CODE><FONT face="courier, monospaced">httpunit.jar</FONT></CODE>.
      </I></FONT></TD></TR></TABLE></P>
    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 3 : Modify Tomcat web.xml</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>
      <P align="justify">
        Edit <CODE><FONT face="courier, monospaced">[tomcat root]/conf/web.xml</FONT></CODE> and add the following at
        the beginning of the file, after the <CODE><FONT face="courier, monospaced">&lt;webapp&gt;</FONT></CODE> tag :
      </P>
<DIV align="center"><TABLE border="1" cellpadding="2" cellspacing="2"><TR><TD><PRE>
&lt;servlet&gt;
    &lt;servlet-name&gt;ServletRedirector&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.apache.cactus.server.ServletTestRedirector&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;param1&lt;/param-name&gt;
      &lt;param-value&gt;value1 used for testing&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/servlet&gt;

&lt;servlet&gt;
    &lt;servlet-name&gt;ServletTestRunner&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.apache.cactus.server.runner.ServletTestRunner&lt;/servlet-class&gt;
&lt;/servlet&gt;
</PRE></TD></TR></TABLE></DIV>

      <P align="justify">
        Then, after the last <CODE><FONT face="courier, monospaced">&lt;servlet&gt;</FONT></CODE> definition (there
        are a few provided by Tomcat in addition to our 2 above), add :
      </P>

<DIV align="center"><TABLE border="1" cellpadding="2" cellspacing="2"><TR><TD><PRE>
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;ServletRedirector&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/ServletRedirector&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;

&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;ServletTestRunner&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/ServletTestRunner&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</PRE></TD></TR></TABLE></DIV>

    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 4 : Creating a sample applicaton to test</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>
      <P align="justify">
        We're now going to create a very very simple application to server
        so that we can unit test it.
      </P>
      <P align="justify">
        First, create the following directory structure :
      </P>

<DIV align="center"><TABLE border="1" cellpadding="2" cellspacing="2"><TR><TD><PRE>
[tomcat root]/webapps
  |_ test
    |_ WEB-INF
      |_ classes
</PRE></TD></TR></TABLE></DIV>

      <P align="justify">
        Then, create the following <CODE><FONT face="courier, monospaced">SampleServlet.java</FONT></CODE> java source
        file, compile it and copy the resulting .class file in
        <CODE><FONT face="courier, monospaced">[tomcat root]/webapps/test/WEB-INF/classes</FONT></CODE>. Note that
        you can download the pre-compiled class file
        <A href="misc/SampleServlet.class">here</A>.
      </P>

<DIV align="center"><TABLE border="1" cellpadding="2" cellspacing="2"><TR><TD><PRE>
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;

public class SampleServlet extends HttpServlet
{
    public void saveToSession(HttpServletRequest request)
    {
    	String testparam = request.getParameter(&quot;testparam&quot;);
    	request.getSession().setAttribute(&quot;testAttribute&quot;, testparam);
    }
}
</PRE></TD></TR></TABLE></DIV>

      <P><TABLE border="0" cellpadding="0" cellspacing="3" width="100%"><TR><TD valign="top" width="28"><IMG alt="Note" border="0" height="29" hspace="0" src="images/note.gif" vspace="0" width="28"></TD><TD valign="top"><FONT color="#000000" face="arial,helvetica,sanserif" size="-1"><I>
        You'll notice that this isn't even a finished servlet ! However, this
        shows that you can start testing your code with Cactus even before
        you have finished writing it completely. Extreme Programmers should
        like this :-)
      </I></FONT></TD></TR></TABLE></P>

      <P align="justify">
        We're now read to create our first Cactus test case. Create the
        following <CODE><FONT face="courier, monospaced">TestSampleServlet.java</FONT></CODE> java source file, compile
        it and copy the resulting .class file in
        <CODE><FONT face="courier, monospaced">[tomcat root]/webapps/test/WEB-INF/classes</FONT></CODE>. Note that
        you can download the pre-compiled class file
        <A href="misc/TestSampleServlet.class">here</A>.
      </P>

<DIV align="center"><TABLE border="1" cellpadding="2" cellspacing="2"><TR><TD><PRE>
import junit.framework.Test;
import junit.framework.TestSuite;

import org.apache.cactus.ServletTestCase;
import org.apache.cactus.WebRequest;

public class TestSampleServlet extends ServletTestCase
{
    public TestSampleServlet(String theName)
    {
        super(theName);
    }

    public static Test suite()
    {
        return new TestSuite(TestSampleServlet.class);
    }

    public void beginSaveToSessionOK(WebRequest webRequest)
    {
        webRequest.addParameter(&quot;testparam&quot;, &quot;it works!&quot;);
    }

    public void testSaveToSessionOK()
    {
        SampleServlet servlet = new SampleServlet();
        servlet.saveToSession(request);
        assertEquals(&quot;it works!&quot;, session.getAttribute(&quot;testAttribute&quot;));
    }
}
</PRE></TD></TR></TABLE></DIV>

    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 5 : Run the test</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>

      <P align="justify">
        Time to enjoy our hard work ! Start Tomcat by running
        <CODE><FONT face="courier, monospaced">[tomcat root]/bin/startup.bat</FONT></CODE> (for windows) or
        <CODE><FONT face="courier, monospaced">[tomcat root]/bin/startup.sh</FONT></CODE> (for unix).
      </P>
      <P align="justify">
        Open a browser and point it at <CODE><FONT face="courier, monospaced">http://localhost:8080/test/ServletTestRunner?suite=TestSampleServlet</FONT></CODE>
      </P>
      <P align="justify">
        You should see :
      </P>
      <P align="center"><IMG alt="XML output of ServletTestRunner" border="0" hspace="4" src="images/tomcat_xml.jpg" vspace="4"></P>

    </FONT></TD></TR></TABLE></DIV><BR>

    <DIV align="right"><TABLE border="0" cellpadding="2" cellspacing="0" width="100%"><TR><TD bgcolor="#525D76"><FONT color="#ffffff" face="arial,helvetica,sanserif" size="+1"><B>Step 6 : Even more fun !</B></FONT></TD></TR><TR><TD><FONT color="#000000" face="arial,helvetica,sanserif"><BR>
      <P align="justify">
        Ok, that's nice ... But what if I want HTML instead of XML ? Don't
        worry there is a solution. Grab the following
        <A href="misc/junit-noframes.xsl">junit-noframes.xsl</A>
        stylesheet used to format JUnitReport Ant task results and drop it in
        <CODE><FONT face="courier, monospaced">[tomcat root]/webapps/test</FONT></CODE>. Then, open a browser and type
        <CODE><FONT face="courier, monospaced">http://localhost:8080/test/ServletTestRunner?suite=TestSampleServlet&amp;xsl=junit-noframes.xsl</FONT></CODE>.
        You should now see the following :
      </P>

      <P align="center"><IMG alt="HTML output of ServletTestRunner" border="0" hspace="4" src="images/tomcat_html.jpg" vspace="4"></P>

      <P><TABLE border="0" cellpadding="0" cellspacing="3" width="100%"><TR><TD valign="top" width="28"><IMG alt="Note" border="0" height="29" hspace="0" src="images/note.gif" vspace="0" width="28"></TD><TD valign="top"><FONT color="#000000" face="arial,helvetica,sanserif" size="-1"><I>
        This will work with Internet Explorer as the XSL transformation is
        performed on the client side (i.e by the browser). I'm not sure
        about other browsers.
      </I></FONT></TD></TR></TABLE></P>
    </FONT></TD></TR></TABLE></DIV><BR>

  
</TD></TR></TABLE></TD></TR></TABLE><BR><TABLE border="0" cellpadding="0" cellspacing="0" width="100%"><TR><TD><HR noshade="" size="1"></TD></TR><TR><TD align="center"><FONT color="#525D76" face="arial,helvetica,sanserif" size="-1"><I>
                Copyright &copy; 2000-2002 The Apache Software Foundation.
                All Rights Reserved.
               </I></FONT></TD></TR></TABLE></BODY></HTML>